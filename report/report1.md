# Лабораторная работа №4

## Цель работы
Изучение основ программирования на языке ассемблера x86-64 для macOS.

## Задание
Написать программу на языке ассемблера, которая выводит на экран строку "Hello, World!".

## Исходный код

### Файл: hello.asm

```asm
global _main
extern _printf
extern _exit

section .data
    msg db 'Hello, World!', 0xa, 0

section .text
_main:
    push rbp
    mov rbp, rsp
    
    lea rdi, [rel msg]
    call _printf
    
    mov rdi, 0
    call _exit
```

## Описание программы

### Структура программы

1. **Директива `global _main`**: Объявляет точку входа программы `_main` как глобальную, чтобы линкер мог её найти.

2. **Директивы `extern`**: Объявляют внешние функции из стандартной библиотеки C:
   - `_printf` - для вывода строки на экран
   - `_exit` - для корректного завершения программы

3. **Секция `.data`**: Содержит данные программы:
   - `msg db 'Hello, World!', 0xa, 0` - определяет строку "Hello, World!" с символом новой строки (0xa) и нулевым терминатором (0)

4. **Секция `.text`**: Содержит исполняемый код:
   - `_main:` - точка входа программы
   - `push rbp` и `mov rbp, rsp` - сохранение и установка указателя на стек (соглашение о вызовах)
   - `lea rdi, [rel msg]` - загрузка адреса строки в регистр RDI (первый аргумент функции в System V ABI для x86-64)
   - `call _printf` - вызов функции printf для вывода строки
   - `mov rdi, 0` и `call _exit` - завершение программы с кодом возврата 0

### Соглашение о вызовах System V ABI

В x86-64 архитектуре для macOS используется соглашение о вызовах System V ABI:
- Первый аргумент функции передается в регистре RDI
- Регистр RBP используется как указатель на базовый кадр стека
- Регистр RSP - указатель на вершину стека

## Компиляция и запуск

### Компиляция
```bash
nasm -f macho64 hello.asm -o hello.o
```

### Линковка
```bash
ld -macosx_version_min 10.7 -lSystem hello.o -o hello
```

### Запуск
```bash
./hello
```

### Результат выполнения
```
Hello, World!
```

## Выводы

В ходе выполнения лабораторной работы были изучены:
- Основы синтаксиса языка ассемблера x86-64
- Структура программы на ассемблере (секции .data и .text)
- Использование внешних функций из стандартной библиотеки C
- Соглашение о вызовах System V ABI для x86-64
- Процесс компиляции и линковки программ на ассемблере для macOS

Программа успешно выводит строку "Hello, World!" на экран и корректно завершается.

## Приложения

### Скриншоты выполнения программы

Скриншоты процесса компиляции, линковки и выполнения программы находятся в папке `screens/`.

